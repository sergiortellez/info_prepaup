function onSignIn(e){var t=e.getBasicProfile();let o=["jmartine@up.edu.mx","rlira@up.edu.mx","dgarciap@up.edu.mx","etovar@up.edu.mx","jgbarrios@up.edu.mx","mcarreon@up.edu.mx","bhikichi@up.edu.mx","mfernandez@up.edu.mx","jlbetancourt@up.edu.mx","jgomezt@up.edu.mx","sergio@huin.mx"];const a=document.getElementById("photoUser");null!=t.getImageUrl()&&(a.src=t.getImageUrl());const r=document.getElementById("mail");if(r.textContent=t.getName(),o.includes(t.getEmail())){const e=document.getElementById("administracion");e.style.display="none";const t=document.getElementById("administracion-menu");t.style.display="none"}}function signOut(){var e=gapi.auth2.getAuthInstance();e.signOut().then(function(){window.open("index.html","_self")})}function checkIfLoggedIn(){const e=gapi.auth2.getAuthInstance().isSignedIn.get();e||window.open("index.html","_self")}function buildData(e){var t=[];fetch(e).then(function(e){return e.json()}).then(e=>{t=e.values,fillPageData(t)})}function buildDataCharts(e){var t=[];fetch(e).then(function(e){return e.json()}).then(e=>{t=e.values,createDataDrawCharts(t)})}function fillPageData(e){let t=document.getElementById("inscritosNum");t.textContent=e[0][0];let o=document.getElementById("bajasNum");o.textContent=e[1][0];let a=document.getElementById("primAvisoAcNum");a.textContent=e[2][0];let r=document.getElementById("segAvisoAcNum");r.textContent=e[3][0];let l=document.getElementById("terAvisoAcNum");l.textContent=e[4][0];let n=document.getElementById("cuarAvisoAcNum");n.textContent=e[5][0];let s=document.getElementById("primAvisoDicNum");s.textContent=e[6][0];let i=document.getElementById("segAvisoDicNum");i.textContent=e[7][0];let c=document.getElementById("terAvisoDicNum");c.textContent=e[8][0];let u=document.getElementById("asisitenciaCapNum");u.textContent=e[9][0];let d=document.getElementById("acreditCapNum");d.textContent=e[10][0];let p=document.getElementById("gacNum");p.textContent=e[11][0];let g=document.getElementById("reprobacionNum");g.textContent=e[12][0];let m=document.getElementById("publicacionesNum");m.textContent=e[13][0],progressBar(parseFloat(e[14][0]),"publicacionesBar");let f=document.getElementById("boletinNum");f.textContent=e[15][0],progressBar(parseFloat(e[16][0]),"boletinBar");let F=document.getElementById("socAlumnosNum");F.textContent=e[17][0],progressBar(parseFloat(e[18][0]),"socAlumnosBar");let y=document.getElementById("ingresosRealNum");y.textContent=e[19][0];let b=document.getElementById("ingresosEsplNum");b.textContent=e[20][0],progressBar(parseFloat(e[21][0]),"ingresosBar");let x=document.getElementById("egresosRealNum");x.textContent=e[22][0];let h=document.getElementById("egresosEsplNum");h.textContent=e[23][0],progressBar(parseFloat(e[24][0]),"egresosBar");let B=document.getElementById("contribucionRealNum");B.textContent=e[25][0];let C=document.getElementById("contribucionEsplNum");C.textContent=e[26][0],progressBar(parseFloat(e[27][0]),"contribucionBar");let v=document.getElementById("ahorroRealNum");v.textContent=e[28][0];let E=document.getElementById("ahorroEsplNum");E.textContent=e[29][0],progressBar(parseFloat(e[30][0]),"ahorroBar");let I=document.getElementById("presupBecasNum");I.textContent=e[31][0];let A=document.getElementById("alumnosBecasNum");A.textContent=e[32][0];let S=document.getElementById("repartidasBecasNum");S.textContent=e[33][0];let w=document.getElementById("solicitantesBecasNum");w.textContent=e[34][0];let N=document.getElementById("asistenciaCursosNum");N.textContent=e[35][0],progressBar(parseFloat(e[36][0]),"asistenciaCursosBar");let z=document.getElementById("cursosNum");z.textContent=e[37][0],progressBar(parseFloat(e[38][0]),"cursosBar");let D=document.getElementById("comiteNum");D.textContent=e[39][0];let k=document.getElementById("citasPsiqNum");k.textContent=e[40][0];let T=document.getElementById("conferenciasNum");T.textContent=e[41][0];let P=document.getElementById("alumnosSelecNum");P.textContent=e[42][0];let R=document.getElementById("inscritosNuevosNum");R.textContent=e[43][0],progressBar(parseFloat(e[44][0]),"inscritosNuevosBar");let L=document.getElementById("inscritosVespNum");L.textContent=e[45][0];let O=document.getElementById("prospectosAtendidosNum");O.textContent=e[46][0];let M=document.getElementById("potencialVivosNum");M.textContent=e[47][0];let j=document.getElementById("aceptadosNum");j.textContent=e[48][0];let Q=document.getElementById("colegiosVisitadosNum");Q.textContent=e[49][0];let U=document.getElementById("contactosLogradosNum");U.textContent=e[50][0];let Y=document.getElementById("eventosRealizadosNum");Y.textContent=e[51][0];let _=document.getElementById("alcanceNum");_.textContent=e[52][0];let J=document.getElementById("engagementNum");J.textContent=e[53][0];let V=document.getElementById("exitoNum");V.textContent=e[54][0];let Z=document.getElementById("asesoriasNum");Z.textContent=e[55][0],progressBar(parseFloat(e[56][0]),"asesoriasBar");let H=document.getElementById("platicasSacerdoteNum");H.textContent=e[57][0]}function progressBar(e,t){let o=document.getElementById(t);o.style.width="Calc("+e+"% - 15%)";let a=document.createElement("div");a.textContent=e+"%",a.classList.toggle("progress-bar"),o.append(a)}function createDataDrawCharts(e){let t=[["Perido","1º Aviso","2º Aviso","3º Aviso","4º aviso"],["1º",parseFloat(e[2][1]),parseFloat(e[2][2]),parseFloat(e[2][3]),parseFloat(e[2][4])],["2º",parseFloat(e[3][1]),parseFloat(e[3][2]),parseFloat(e[3][3]),parseFloat(e[3][4])],["3º",parseFloat(e[4][1]),parseFloat(e[4][2]),parseFloat(e[4][3]),parseFloat(e[4][4])],["4º",parseFloat(e[5][1]),parseFloat(e[5][2]),parseFloat(e[5][3]),parseFloat(e[5][4])],["5º",parseFloat(e[6][1]),parseFloat(e[6][2]),parseFloat(e[6][3]),parseFloat(e[6][4])]];google.setOnLoadCallback(function(){drawAvisosAdemicos(t)});let o=[["Grado","1º Aviso","2º Aviso","3º Aviso"],["Cuarto",parseFloat(e[10][1]),parseFloat(e[10][2]),parseFloat(e[10][3])],["Quinto",parseFloat(e[11][1]),parseFloat(e[11][2]),parseFloat(e[11][3])],["Sexto",parseFloat(e[12][1]),parseFloat(e[12][2]),parseFloat(e[12][3])]];google.setOnLoadCallback(function(){drawAvisosDisciplinares(o)});let a=[[1,parseFloat(e[15][0])],[2,parseFloat(e[15][1])],[3,parseFloat(e[15][2])],[4,parseFloat(e[15][3])],[5,parseFloat(e[15][4])]];google.setOnLoadCallback(function(){drawReprobadas(a)});let r=[["Task","Hours per Day"],["% cumplido ",parseFloat(e[17][1])],["% faltante",parseFloat(e[17][2])]];google.setOnLoadCallback(function(){drawChartServicio(r)});let l=[["Task","Hours per Day"],["Ejercido",parseFloat(e[19][1])],["Disponible",parseFloat(e[19][2])]];google.setOnLoadCallback(function(){drawPresupuestoChart(l)});let n=[["Mes","Real","Presupuestado"],["Agosto",parseFloat(e[22][0]),parseFloat(e[23][0])],["Septiembre",parseFloat(e[22][1]),parseFloat(e[23][1])],["Octubre",parseFloat(e[22][2]),parseFloat(e[23][2])],["Noviembre",parseFloat(e[22][3]),parseFloat(e[23][3])],["Diciembre",parseFloat(e[22][4]),parseFloat(e[23][4])],["Enero",parseFloat(e[22][5]),parseFloat(e[23][5])],["Febrero",parseFloat(e[22][6]),parseFloat(e[23][6])],["Marzo",parseFloat(e[22][7]),parseFloat(e[23][7])],["Abril",parseFloat(e[22][8]),parseFloat(e[23][8])],["Mayo",parseFloat(e[22][9]),parseFloat(e[23][9])],["Junio",parseFloat(e[22][10]),parseFloat(e[23][10])],["Julio",parseFloat(e[22][11]),parseFloat(e[23][11])]];google.setOnLoadCallback(function(){drawIngresos(n)});let s=[["Mes","Real","Presupuestado"],["Agosto",parseFloat(e[26][0]),parseFloat(e[27][0])],["Septiembre",parseFloat(e[26][1]),parseFloat(e[27][1])],["Octubre",parseFloat(e[26][2]),parseFloat(e[27][2])],["Noviembre",parseFloat(e[26][3]),parseFloat(e[27][3])],["Diciembre",parseFloat(e[26][4]),parseFloat(e[27][4])],["Enero",parseFloat(e[26][5]),parseFloat(e[27][5])],["Febrero",parseFloat(e[26][6]),parseFloat(e[27][6])],["Marzo",parseFloat(e[26][7]),parseFloat(e[27][7])],["Abril",parseFloat(e[26][8]),parseFloat(e[27][8])],["Mayo",parseFloat(e[26][9]),parseFloat(e[27][9])],["Junio",parseFloat(e[26][10]),parseFloat(e[27][10])],["Julio",parseFloat(e[26][11]),parseFloat(e[27][11])]];google.setOnLoadCallback(function(){drawEgresos(s)});let i=[["Mes","Real","Presupuestado"],["Agosto",parseFloat(e[30][0]),parseFloat(e[31][0])],["Septiembre",parseFloat(e[30][1]),parseFloat(e[31][1])],["Octubre",parseFloat(e[30][2]),parseFloat(e[31][2])],["Noviembre",parseFloat(e[30][3]),parseFloat(e[31][3])],["Diciembre",parseFloat(e[30][4]),parseFloat(e[31][4])],["Enero",parseFloat(e[30][5]),parseFloat(e[31][5])],["Febrero",parseFloat(e[30][6]),parseFloat(e[31][6])],["Marzo",parseFloat(e[30][7]),parseFloat(e[31][7])],["Abril",parseFloat(e[30][8]),parseFloat(e[31][8])],["Mayo",parseFloat(e[30][9]),parseFloat(e[31][9])],["Junio",parseFloat(e[30][10]),parseFloat(e[31][10])],["Julio",parseFloat(e[30][11]),parseFloat(e[31][11])]];google.setOnLoadCallback(function(){drawContribucion(i)});let c=[["Element","% completado",{role:"style"},{role:"annotation"}],["",parseFloat(e[35][0]),"#b87333","1ª Entrevista"],["",parseFloat(e[35][1]),"#b87333","2ª Entrevista"],["",parseFloat(e[35][2]),"#b87333","3ª Entrevista"],["",parseFloat(e[35][3]),"#b87333","4ª Entrevista"],["",parseFloat(e[35][4]),"#b87333","5ª Entrevista"],["",parseFloat(e[35][5]),"#b87333","6ª Entrevista"]];google.setOnLoadCallback(function(){drawAsesoriasChart(c)})}function drawAvisosAdemicos(e){var t=google.visualization.arrayToDataTable(e),o={chart:{title:"Avisos Académicos",subtitle:"Reporte por periodo"},chartArea:{backgroundColor:"transparent"},bars:"vertical",vAxis:{textStyle:{color:"#FFF"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},hAxis:{textStyle:{color:"#fff"}},height:400,colors:["white","#1b9e77","gold","red"],backgroundColor:{fill:"transparent"},legend:{color:"#fff",position:"none",textStyle:{color:"#fff"}}},a=new google.charts.Bar(document.getElementById("grafica-avisos-academicos"));a.draw(t,google.charts.Bar.convertOptions(o))}function drawAvisosDisciplinares(e){var t=google.visualization.arrayToDataTable(e),o={chart:{title:"Avisos Disciplinares por grado",subtitle:"Reporte acumulado"},chartArea:{backgroundColor:"transparent"},bars:"vertical",vAxis:{textStyle:{color:"#FFF"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},hAxis:{textStyle:{color:"#fff"}},height:400,colors:["#1b9e77","gold","red"],backgroundColor:{fill:"transparent"},legend:{color:"#fff",position:"none",textStyle:{color:"#fff"}}},a=new google.charts.Bar(document.getElementById("grafica-avisos-disciplinares"));a.draw(t,google.charts.Bar.convertOptions(o))}function drawReprobadas(e){var t=new google.visualization.DataTable;t.addColumn("number","X"),t.addColumn("number","Tendencia"),t.addRows(e);var o={hAxis:{title:"Periodo",textStyle:{color:"#FFF"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},vAxis:{title:"# Materias reprobadas",textStyle:{color:"#fff"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},width:"100%",height:"100%",colors:["#278527","#e0440e"],backgroundColor:{fill:"transparent"},legend:{color:"#fff",position:"bottom",textStyle:{color:"#fff"}}},a=new google.visualization.LineChart(document.getElementById("numReprobadas"));a.draw(t,o)}function drawChartServicio(e){var t=google.visualization.arrayToDataTable(e),o={title:"Servicio Social",titleTextStyle:{color:"#fff",fontSize:20},legend:{color:"#fff",position:"bottom",textStyle:{color:"#fff"}},width:"100%",height:"100%",colors:["#afa120","#e0440e"],backgroundColor:{fill:"transparent"}},a=new google.visualization.PieChart(document.getElementById("piechart-servicio"));a.draw(t,o)}function drawPresupuestoChart(e){var t=google.visualization.arrayToDataTable(e),o={title:"Presupuesto",pieHole:.4,titleTextStyle:{color:"#fff",fontSize:20},legend:{color:"#fff",position:"bottom",textStyle:{color:"#fff"}},width:"100%",height:"100%",colors:["#278527","#e0440e"],backgroundColor:{fill:"transparent"}},a=new google.visualization.PieChart(document.getElementById("piechart-presupuesto"));a.draw(t,o)}function drawAsesoriasChart(e){var t=google.visualization.arrayToDataTable(e),o=new google.visualization.DataView(t);o.setColumns([0,1,{calc:"stringify",sourceColumn:1,type:"string",role:"annotation"},2]);var a={title:"Asesorías por periodo",titleTextStyle:{color:"#fff",fontSize:20},legend:{color:"#fff",position:"none",textStyle:{color:"#fff"}},hAxis:{textStyle:{color:"#fff"}},width:"100%",height:"100%",colors:["#afa120","#e0440e"],backgroundColor:{fill:"transparent"}},r=new google.visualization.BarChart(document.getElementById("bars-asesorias"));r.draw(t,a)}function drawIngresos(e){var t=google.visualization.arrayToDataTable(e),o={chart:{title:"Ingresos: Real vs Presupuestado",subtitle:"Reporte mensual"},chartArea:{backgroundColor:"transparent"},bars:"vertical",vAxis:{format:"$###,###",textStyle:{color:"#FFF"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},hAxis:{textStyle:{color:"#fff"}},height:400,colors:["#1b9e77","#d95f02"],backgroundColor:{fill:"transparent"},legend:{color:"#fff",position:"none",textStyle:{color:"#fff"}}},a=new google.charts.Bar(document.getElementById("ingresos"));a.draw(t,google.charts.Bar.convertOptions(o))}function drawEgresos(e){var t=google.visualization.arrayToDataTable(e),o={chart:{title:"Egresos: Real vs Presupuestado",subtitle:"Reporte mensual"},chartArea:{backgroundColor:"transparent"},bars:"vertical",vAxis:{format:"$###,###",textStyle:{color:"#FFF"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},hAxis:{textStyle:{color:"#fff"}},height:400,colors:["#1b9e77","#d95f02"],backgroundColor:{fill:"transparent"},legend:{color:"#fff",position:"none",textStyle:{color:"#fff"}}},a=new google.charts.Bar(document.getElementById("egresos"));a.draw(t,google.charts.Bar.convertOptions(o))}function drawContribucion(e){var t=google.visualization.arrayToDataTable(e),o={chart:{title:"Contribución: Real vs Presupuestado",subtitle:"Reporte mensual"},chartArea:{backgroundColor:"transparent"},bars:"vertical",vAxis:{format:"$###,###",textStyle:{color:"#FFF"},titleTextStyle:{color:"#fff",fontSize:15,bold:!0}},hAxis:{textStyle:{color:"#fff"}},height:400,colors:["#1b9e77","#d95f02"],backgroundColor:{fill:"transparent"},legend:{color:"#fff",position:"none",textStyle:{color:"#fff"}}},a=new google.charts.Bar(document.getElementById("contribucion"));a.draw(t,google.charts.Bar.convertOptions(o))}const URLdata="https://sheets.googleapis.com/v4/spreadsheets/1ZX90uRbL2zQcVfPiMp_Y3K-WI0BxQPooSgr00QLPS_g/values/main!A1:A58?key=AIzaSyDzdEQYUcSwjzEmZNZhYd2vh1E_P6ykPAY",URLChartsData="https://sheets.googleapis.com/v4/spreadsheets/1ZX90uRbL2zQcVfPiMp_Y3K-WI0BxQPooSgr00QLPS_g/values/charts!A1:L36?key=AIzaSyDzdEQYUcSwjzEmZNZhYd2vh1E_P6ykPAY";google.charts.load("current",{packages:["corechart","bar"]}),window.onload=function(){buildData(URLdata),buildDataCharts(URLChartsData),checkIfLoggedIn()};